ENV_NAME = sr-hydra2
# PYTHON_VERSION = 3.11

CONDA := $(shell which conda)

help:  ## Show help
	@grep -E '^[.a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}'

create-conda:	## Setup env
	$(CONDA) env create --file environment.yaml python=$(PYTHON_VERSION) -y
#	$(CONDA) run --name $(ENV_NAME) pip install -r ./docs/requirements.txt

train: ## Train the model
	$(CONDA) run -n $(ENV_NAME) python src/train.py experiment=train.yaml

predict: ## Predict using the model
	$(CONDA) run -n $(ENV_NAME) && python src/predict.py experiment=predict.yaml

clean: ## Clean autogenerated files
	rm -rf dist
	find . -type f -name "*.DS_Store" -ls -delete
	find . | grep -E "(__pycache__|\.pyc|\.pyo)" | xargs rm -rf
	find . | grep -E ".pytest_cache" | xargs rm -rf
	find . | grep -E ".ipynb_checkpoints" | xargs rm -rf
	rm -f .coverage

clean-logs: ## Clean logs
	rm -rf logs/**

remove-conda: ## Remove Conda environment
	$(CONDA) remove --name $(ENV_NAME) --all -y
